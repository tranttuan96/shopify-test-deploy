import{_ as f,a as t,b as v,z as Y}from"./theme-74fe61d9.js";import{c as W,a as V,h as m,n as w,d as Z,l as y,o as tt,p as et,i as $,e as it,b as q,s as st,f as ot,g as rt,r as J,D as at,m as k,t as S,E as U,F as nt,G as O,H as K,u as dt,z as lt,A as ht,I as ct}from"./index.esm-66056b1d.js";import{g as ut}from"./index-2a24c684-15d4fbf4.js";/* empty css              */const I=s=>s.me.data,E=W(I,s=>s.picture),P=W(I,s=>s.email),F=W(I,s=>s.verifiedEmail),C=W(I,s=>s.name),T=W(I,s=>s.phone),L=W(I,s=>s.verifiedPhone),D=W(I,s=>s.webauthn);W(I,s=>s.password);const Q=s=>(...i)=>e=>{e.addCase(s.pending,(a,o)=>{i.forEach(({onPending:r})=>{r==null||r(a,o)})}),e.addCase(s.fulfilled,(a,o)=>{i.forEach(({onFulfilled:r})=>{r==null||r(a,o)})}),e.addCase(s.rejected,(a,o)=>{i.forEach(({onRejected:r})=>{r==null||r(a,o)})})},X=V("users/me",(s,{extra:{api:i}})=>i.user.me()),gt=Q(X)({onFulfilled:(s,i)=>{s.me.data=i.payload}},(A=s=>s.me,{onFulfilled:s=>{A(s).loading=!1},onPending:s=>{A(s).loading=!0,A(s).error=null},onRejected:(s,i)=>{A(s).loading=!1,A(s).error=i.error}}));var A;const N={action:X,reducer:gt},_=V("users/logout",(s,{extra:{api:i}})=>i.user.logout()),H={action:_,reducer:Q(_)({})},z={me:{loading:!1,error:null,data:{}}},ft={me:"/v1/auth/me"},vt=()=>f(void 0,void 0,void 0,function*(){return new Promise(s=>{s({loginIds:["user@company.com"],externalIds:["user@company.com"],userId:"user-1",name:"Test User",email:"user@company.com",roleNames:["Role"],phone:"+1-202-555-010",verifiedEmail:!0,verifiedPhone:!0,userTenants:[],status:"enabled",editable:!0,createdTime:new Date().getTime(),customAttributes:{},familyName:"",givenName:"",middleName:"",picture:void 0,password:!0,SAML:!1,test:!1,TOTP:!1,webauthn:!0})})}),pt=({httpClient:s,mock:i})=>({me:()=>f(void 0,void 0,void 0,function*(){if(i)return vt();const e=yield s.get(ft.me);return yield(a=>f(void 0,void 0,void 0,function*(){const o=yield a.text(),r=JSON.parse(o);if(!a.ok){const c=`${r.errorDescription}${r.errorMessage?`: ${r.errorMessage}`:""}`;throw Error(c||`${a.status} ${a.statusText}`)}a.json=()=>Promise.resolve(r),a.text=()=>Promise.resolve(o)}))(e),e.json()})}),wt=m(s=>{var i,e,a,o;const r=w(et,tt,y,Z)(s);return o=class extends r{constructor(){super(...arguments),i.add(this),e.set(this,void 0)}get widgetId(){return this.getAttribute("widget-id")}get mock(){return this.getAttribute("mock")}get api(){return t(this,e,"f")||t(this,i,"m",a).call(this),t(this,e,"f")}init(){const c=Object.create(null,{init:{get:()=>super.init}});var d;return f(this,void 0,void 0,function*(){yield(d=c.init)===null||d===void 0?void 0:d.call(this),this.observeAttributes(["project-id","base-url"],()=>{t(this,e,"f")&&t(this,i,"m",a).call(this)})})}},e=new WeakMap,i=new WeakSet,a=function(){this.logger.debug("creating an sdk instance"),v(this,e,((c,d,h)=>{const l=Y(Object.assign(Object.assign({},c),{persistTokens:!0,baseHeaders:{"x-descope-widget-type":"user-profile-widget","x-descope-widget-id":h,"x-descope-widget-version":"0.0.91"}}));return{user:Object.assign(Object.assign({},pt({httpClient:l.httpClient,mock:d})),{logout:d?()=>f(void 0,void 0,void 0,function*(){}):l.logout})}})({projectId:this.projectId,baseUrl:this.baseUrl},this.mock==="true",this.widgetId),"f")},o}),M=m(s=>{const i=w(it({name:"widget",initialState:z,reducers:{},extraReducers:e=>{N.reducer(e),H.reducer(e)},asyncActions:{getMe:N.action,logout:H.action}}),$,y,wt)(s);return class extends i{constructor(...e){super(...e),this.state=z,this.subscribe(a=>{this.logger.debug("State update:",a),this.state=a})}}}),mt=m(s=>{const i=w(st,q({"widget-id":q.missingAttrValidator}))(s);return class extends i{get widgetId(){return this.getAttribute("widget-id")}fetchWidgetPage(e){return f(this,void 0,void 0,function*(){return(yield this.fetchStaticResource(`user-profile-widget/${this.widgetId}/${e}`,"text")).body})}}}),x=m(s=>{var i,e,a;return a=class extends w(y,$,rt,ot,mt,M)(s){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){return f(this,void 0,void 0,function*(){})}init(){const o=Object.create(null,{init:{get:()=>super.init}});var r;return f(this,void 0,void 0,function*(){yield(r=o.init)===null||r===void 0?void 0:r.call(this),yield Promise.all([this.actions.getMe(),t(this,i,"m",e).call(this)]),this.onWidgetRootReady()})}},i=new WeakSet,e=function(){return f(this,void 0,void 0,function*(){const o=J(yield this.fetchWidgetPage("root.html"));yield this.loadDescopeUiComponents(o),this.contentRootElement.append(o.content.cloneNode(!0))})},a}),R=(s={})=>{const i=J("<descope-wc></descope-wc>");return Object.entries(s).forEach(([e,a])=>{i.content.querySelector("descope-wc").setAttribute(ct(e),a)}),i};function B(s){return new URLSearchParams(window.location.search).get(s)}const bt=m(s=>{var i,e,a,o,r,c,d,h,l;return l=class extends w(M,y,x,k,at)(s){constructor(){super(...arguments),i.add(this),e.set(this,void 0),a.set(this,void 0),d.set(this,S(u=>{this.avatar.image=u})),h.set(this,S(u=>{this.avatar.displayName=u}))}onWidgetRootReady(){const u=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});var p;return f(this,void 0,void 0,function*(){yield(p=u.onWidgetRootReady)===null||p===void 0?void 0:p.call(this),t(this,i,"m",c).call(this),t(this,i,"m",o).call(this),t(this,d,"f").call(this,E(this.state)),t(this,h,"f").call(this,C(this.state)),this.subscribe(t(this,d,"f").bind(this),E),this.subscribe(t(this,h,"f").bind(this),C)})}},e=new WeakMap,a=new WeakMap,d=new WeakMap,h=new WeakMap,i=new WeakSet,o=function(){v(this,e,this.createModal({"data-id":"update-pic"}),"f"),v(this,a,new U(()=>{var u;return(u=t(this,e,"f").ele)===null||u===void 0?void 0:u.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,e,"f").afterClose=t(this,i,"m",r).bind(this),t(this,i,"m",r).call(this)},r=function(){t(this,e,"f").setContent(R({projectId:this.projectId,flowId:this.avatar.flowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,a,"f").onSuccess(()=>{t(this,e,"f").close(),this.actions.getMe()})},c=function(){this.avatar=new nt(()=>{var u;return(u=this.shadowRoot)===null||u===void 0?void 0:u.querySelector("descope-avatar")},{logger:this.logger}),this.avatar.onClick(()=>{t(this,e,"f").open()})},l}),yt=m(s=>{var i,e,a,o,r,c,d,h,l,u,p,b,g;return g=class extends w(M,y,x,k)(s){constructor(){super(...arguments),i.add(this),e.set(this,void 0),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),p.set(this,S(n=>{this.emailUserAttr.value=n})),b.set(this,S(n=>{this.emailUserAttr.badgeLabel=n?"":"Unverified"}))}onWidgetRootReady(){const n=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});var j;return f(this,void 0,void 0,function*(){yield(j=n.onWidgetRootReady)===null||j===void 0?void 0:j.call(this),t(this,i,"m",u).call(this),t(this,i,"m",c).call(this),t(this,i,"m",h).call(this),t(this,p,"f").call(this,P(this.state)),t(this,b,"f").call(this,F(this.state)),this.subscribe(t(this,p,"f").bind(this),P),this.subscribe(t(this,b,"f").bind(this),F)})}},e=new WeakMap,a=new WeakMap,o=new WeakMap,r=new WeakMap,p=new WeakMap,b=new WeakMap,i=new WeakSet,c=function(){v(this,e,this.createModal({"data-id":"edit-email"}),"f"),v(this,a,new U(()=>{var n;return(n=t(this,e,"f").ele)===null||n===void 0?void 0:n.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,e,"f").afterClose=t(this,i,"m",d).bind(this),t(this,i,"m",d).call(this)},d=function(){t(this,e,"f").setContent(R({projectId:this.projectId,flowId:this.emailUserAttr.editFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,a,"f").onSuccess(()=>{t(this,e,"f").close(),this.actions.getMe()})},h=function(){v(this,o,this.createModal({"data-id":"delete-email"}),"f"),v(this,r,new U(()=>{var n;return(n=t(this,o,"f").ele)===null||n===void 0?void 0:n.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,o,"f").afterClose=t(this,i,"m",l).bind(this),t(this,i,"m",l).call(this)},l=function(){t(this,o,"f").setContent(R({projectId:this.projectId,flowId:this.emailUserAttr.deleteFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,r,"f").onSuccess(()=>{t(this,o,"f").close(),this.actions.getMe()})},u=function(){this.emailUserAttr=new O(()=>{var n;return(n=this.shadowRoot)===null||n===void 0?void 0:n.querySelector('descope-user-attribute[data-id="email"]')},{logger:this.logger}),this.emailUserAttr.onEditClick(()=>{t(this,e,"f").open()}),this.emailUserAttr.onDeleteClick(()=>{t(this,o,"f").open()})},g}),Ut=m(s=>{var i,e,a,o,r,c,d,h,l,u,p,b;return b=class extends w(M,y,x,k)(s){constructor(){super(...arguments),i.add(this),e.set(this,void 0),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),p.set(this,S(g=>{this.nameUserAttr.value=g}))}onWidgetRootReady(){const g=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});var n;return f(this,void 0,void 0,function*(){yield(n=g.onWidgetRootReady)===null||n===void 0?void 0:n.call(this),t(this,i,"m",u).call(this),t(this,i,"m",c).call(this),t(this,i,"m",h).call(this),t(this,p,"f").call(this,C(this.state)),this.subscribe(t(this,p,"f").bind(this),C)})}},e=new WeakMap,a=new WeakMap,o=new WeakMap,r=new WeakMap,p=new WeakMap,i=new WeakSet,c=function(){v(this,e,this.createModal({"data-id":"edit-name"}),"f"),v(this,a,new U(()=>{var g;return(g=t(this,e,"f").ele)===null||g===void 0?void 0:g.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,e,"f").afterClose=t(this,i,"m",d).bind(this),t(this,i,"m",d).call(this)},d=function(){t(this,e,"f").setContent(R({projectId:this.projectId,flowId:this.nameUserAttr.editFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,a,"f").onSuccess(()=>{t(this,e,"f").close(),this.actions.getMe()})},h=function(){v(this,o,this.createModal({"data-id":"delete-name"}),"f"),v(this,r,new U(()=>{var g;return(g=t(this,o,"f").ele)===null||g===void 0?void 0:g.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,o,"f").afterClose=t(this,i,"m",l).bind(this),t(this,i,"m",l).call(this)},l=function(){t(this,o,"f").setContent(R({projectId:this.projectId,flowId:this.nameUserAttr.deleteFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,r,"f").onSuccess(()=>{t(this,o,"f").close(),this.actions.getMe()})},u=function(){this.nameUserAttr=new O(()=>{var g;return(g=this.shadowRoot)===null||g===void 0?void 0:g.querySelector('descope-user-attribute[data-id="name"]')},{logger:this.logger}),this.nameUserAttr.onEditClick(()=>{t(this,e,"f").open()}),this.nameUserAttr.onDeleteClick(()=>{t(this,o,"f").open()})},b}),Rt=m(s=>{var i,e,a,o,r,c,d,h,l,u,p,b,g;return g=class extends w(M,y,x,k)(s){constructor(){super(...arguments),i.add(this),e.set(this,void 0),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),p.set(this,S(n=>{this.phoneUserAttr.value=n})),b.set(this,S(n=>{this.phoneUserAttr.badgeLabel=n?"":"Unverified"}))}onWidgetRootReady(){const n=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});var j;return f(this,void 0,void 0,function*(){yield(j=n.onWidgetRootReady)===null||j===void 0?void 0:j.call(this),t(this,i,"m",u).call(this),t(this,i,"m",c).call(this),t(this,i,"m",h).call(this),t(this,p,"f").call(this,T(this.state)),t(this,b,"f").call(this,L(this.state)),this.subscribe(t(this,p,"f").bind(this),T),this.subscribe(t(this,b,"f").bind(this),L)})}},e=new WeakMap,a=new WeakMap,o=new WeakMap,r=new WeakMap,p=new WeakMap,b=new WeakMap,i=new WeakSet,c=function(){v(this,e,this.createModal({"data-id":"edit-phone"}),"f"),v(this,a,new U(()=>{var n;return(n=t(this,e,"f").ele)===null||n===void 0?void 0:n.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,e,"f").afterClose=t(this,i,"m",d).bind(this),t(this,i,"m",d).call(this)},d=function(){t(this,e,"f").setContent(R({projectId:this.projectId,flowId:this.phoneUserAttr.editFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,a,"f").onSuccess(()=>{t(this,e,"f").close(),this.actions.getMe()})},h=function(){v(this,o,this.createModal({"data-id":"delete-phone"}),"f"),v(this,r,new U(()=>{var n;return(n=t(this,o,"f").ele)===null||n===void 0?void 0:n.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,o,"f").afterClose=t(this,i,"m",l).bind(this),t(this,i,"m",l).call(this)},l=function(){t(this,o,"f").setContent(R({projectId:this.projectId,flowId:this.phoneUserAttr.deleteFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,r,"f").onSuccess(()=>{t(this,o,"f").close(),this.actions.getMe()})},u=function(){this.phoneUserAttr=new O(()=>{var n;return(n=this.shadowRoot)===null||n===void 0?void 0:n.querySelector('descope-user-attribute[data-id="phone"]')},{logger:this.logger}),this.phoneUserAttr.onEditClick(()=>{t(this,e,"f").open()}),this.phoneUserAttr.onDeleteClick(()=>{t(this,o,"f").open()})},g}),Mt=m(s=>{var i,e,a,o,r,c,d,h;return h=class extends w(M,y,x,k)(s){constructor(){super(...arguments),i.add(this),e.set(this,void 0),a.set(this,void 0),d.set(this,S(l=>{this.passkeyUserAuthMethod.fulfilled=l}))}onWidgetRootReady(){const l=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});var u;return f(this,void 0,void 0,function*(){yield(u=l.onWidgetRootReady)===null||u===void 0?void 0:u.call(this),t(this,i,"m",c).call(this),t(this,i,"m",o).call(this),t(this,d,"f").call(this,D(this.state)),this.subscribe(t(this,d,"f").bind(this),D)})}},e=new WeakMap,a=new WeakMap,d=new WeakMap,i=new WeakSet,o=function(){v(this,e,this.createModal({"data-id":"passkey"}),"f"),v(this,a,new U(()=>{var l;return(l=t(this,e,"f").ele)===null||l===void 0?void 0:l.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,e,"f").afterClose=t(this,i,"m",r).bind(this),t(this,i,"m",r).call(this)},r=function(){t(this,e,"f").setContent(R({projectId:this.projectId,flowId:this.passkeyUserAuthMethod.flowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,a,"f").onSuccess(()=>{t(this,e,"f").close(),this.actions.getMe()})},c=function(){this.passkeyUserAuthMethod=new K(()=>{var l;return(l=this.shadowRoot)===null||l===void 0?void 0:l.querySelector('descope-user-auth-method[data-id="passkey"]')},{logger:this.logger}),this.passkeyUserAuthMethod.onButtonClick(()=>{t(this,e,"f").open()})},h}),St=m(s=>{var i,e,a,o,r,c,d;return d=class extends w(M,y,x,k)(s){constructor(){super(...arguments),i.add(this),e.set(this,void 0),a.set(this,void 0)}onWidgetRootReady(){const h=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});var l;return f(this,void 0,void 0,function*(){yield(l=h.onWidgetRootReady)===null||l===void 0?void 0:l.call(this),t(this,i,"m",c).call(this),t(this,i,"m",o).call(this)})}},e=new WeakMap,a=new WeakMap,i=new WeakSet,o=function(){v(this,e,this.createModal({"data-id":"password"}),"f"),v(this,a,new U(()=>{var h;return(h=t(this,e,"f").ele)===null||h===void 0?void 0:h.querySelector("descope-wc")},{logger:this.logger}),"f"),t(this,e,"f").afterClose=t(this,i,"m",r).bind(this),t(this,i,"m",r).call(this)},r=function(){t(this,e,"f").setContent(R({projectId:this.projectId,flowId:this.passwordUserAuthMethod.flowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),t(this,a,"f").onSuccess(()=>{t(this,e,"f").close()})},c=function(){this.passwordUserAuthMethod=new K(()=>{var h;return(h=this.shadowRoot)===null||h===void 0?void 0:h.querySelector('descope-user-auth-method[data-id="password"]')},{logger:this.logger}),this.passwordUserAuthMethod.onButtonClick(()=>{t(this,e,"f").open()})},d}),Wt=m(s=>{var i,e,a;return a=class extends w(M,y,x,k)(s){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){const o=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});var r;return f(this,void 0,void 0,function*(){yield(r=o.onWidgetRootReady)===null||r===void 0?void 0:r.call(this),t(this,i,"m",e).call(this)})}},i=new WeakSet,e=function(){this.logout=new dt(()=>{var o;return(o=this.shadowRoot)===null||o===void 0?void 0:o.querySelector('descope-button[data-id="logout"]')},{logger:this.logger}),this.logout.onClick(()=>f(this,void 0,void 0,function*(){yield this.actions.logout(),this.dispatchEvent(new CustomEvent("logout"))}))},a}),G="widget-flow",kt=m(s=>{var i,e,a;return a=class extends w($,k,M,y)(s){constructor(){super(...arguments),i.add(this)}init(){const o=Object.create(null,{init:{get:()=>super.init}});var r;return f(this,void 0,void 0,function*(){yield(r=o.init)===null||r===void 0?void 0:r.call(this);const c=B(G);c&&(function(d){if(window.history.replaceState&&B(d)){const h=new URL(window.location.href),l=new URLSearchParams(h.search);l.delete(d),h.search=l.toString(),window.history.replaceState({},"",h.toString())}}(G),t(this,i,"m",e).call(this,c))})}},i=new WeakSet,e=function(o){const r=this.createModal({"data-id":"redirect-flow"});r.setContent(R({projectId:this.projectId,flowId:o,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl})),new U(()=>{var d;return(d=r.ele)===null||d===void 0?void 0:d.querySelector("descope-wc")},{logger:this.logger}).onSuccess(()=>{r.close(),this.actions.getMe()}),r.afterClose=()=>{r.remove()},r.open()},a}),It=m(s=>class extends w(ht,lt,kt,yt,bt,Ut,Rt,Mt,St,Wt)(s){init(){const i=Object.create(null,{init:{get:()=>super.init}});var e;return f(this,void 0,void 0,function*(){yield(e=i.init)===null||e===void 0?void 0:e.call(this)})}}),jt=w(s=>class extends It(s){init(){const i=Object.create(null,{init:{get:()=>super.init}});var e;return f(this,void 0,void 0,function*(){yield(e=i.init)===null||e===void 0?void 0:e.call(this),ut.sdkConfigOverrides={baseHeaders:{"x-descope-widget-type":"user-profile-widget","x-descope-widget-id":this.getAttribute("widget-id"),"x-descope-widget-version":"0.0.91"}}})}})(HTMLElement);customElements.define("descope-user-profile-widget",jt);export{jt as default};
